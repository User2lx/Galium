<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Galium</title>
  <style>
    body {
      margin: 0;
      background: white;
    }
    #title {
      text-align: center;
      font-size: 100px;
      margin-top: 50px;
    }
    #stopBtn {
      position: fixed;
      top: 10px;
      right: 10px;
      padding: 10px 20px;
      font-size: 18px;
      cursor: pointer;
      background-color: red;
      color: white;
      border: none;
      border-radius: 8px;
      display: none;
    }
    #tutorial {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      max-width: 90vw;
      max-height: 90vh;
      z-index: 999;
    }
  </style>
</head>
<body id="bodyEl">
  <h1 id="title"></h1>
  <img id="tutorial" src="https://i.univbkstr.com/v3/img/howTo/chrome_imgMain.png" alt="Enable Popups Tutorial">
  <button id="stopBtn">STOP</button>

  <script>
    const title = document.getElementById('title');
    const body = document.getElementById('bodyEl');
    const stopBtn = document.getElementById('stopBtn');
    const tutorial = document.getElementById('tutorial');

    const music = new Audio('music.mp3');
    music.loop = true;

    let nextAn = 1;
    let indexN = 0;
    let wordlist = ['you', 'are', 'an', 'idiot'];
    let popups = [];

    function getRandomCoordinates() {
      return [
        Math.floor(Math.random() * (screen.width - 100)),
        Math.floor(Math.random() * (screen.height - 100))
      ];
    }

    function createNewPopUp() {
      let newWindow = window.open('index.html', '', 'width=350,height=200');
      if (newWindow) popups.push(newWindow);
    }

    let popupsActive = false;

    function startMadness() {
      if (popupsActive) return;
      popupsActive = true;

      tutorial.style.display = 'none';
      stopBtn.style.display = 'block';

      music.play();
      popups.push(window);

      setInterval(() => {
        for (let i = 0; i < popups.length; i++) {
          try {
            let [x, y] = getRandomCoordinates();
            popups[i].moveTo(x, y);
            popups[i].focus();
          } catch (e) { }
        }
      }, 50);

      setInterval(() => {
        title.textContent = wordlist[indexN];
        if (nextAn == 1) {
          title.style.color = 'black';
          body.style.backgroundColor = 'white';
          nextAn = 2;
        } else {
          title.style.color = 'white';
          body.style.backgroundColor = 'black';
          nextAn = 1;
        }
        indexN = (indexN + 1) % wordlist.length;
      }, 400);
    }

    window.addEventListener('keydown', (e) => {
      startMadness();
      for (let i = 0; i < 20; i++) createNewPopUp();
      e.preventDefault();
    });

    window.addEventListener('load', () => {
      title.style.marginTop = (window.innerHeight / 2 - 120).toString() + "px";
    });

    window.addEventListener('resize', () => {
      title.style.marginTop = (window.innerHeight / 2 - 120).toString() + "px";
    });

    stopBtn.addEventListener('click', () => {
      for (let i = 0; i < popups.length; i++) {
        try { popups[i].close(); } catch (e) {}
      }
      music.pause();
      music.currentTime = 0;
    });
  </script>
</body>
</html>
